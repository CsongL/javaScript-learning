# 浏览器原理

## 浏览器进程与线程

浏览器内有多个进程，多个进程之间互不影响，

主要的进程有：

* 浏览器进程 主要是负责界面显示，用户交互，子进程管理，同时提供存储等功能
* 渲染进程 html css 和 javascript代码是在渲染进程中  
* GPU进程 是为了实现3d css的效果
* 网络进程 页面网络资源的加载
* 插件进程

## 为什么很多站点第二次打开速度会很快？

### 缓存机制 

缓存机制的实现主要是依赖于响应头部的一些字段

浏览器的缓存主要是包含两块的数据： **DNS缓存** 和 **页面资源缓存** 

* **DNS缓存**

  ​	DNS缓存其实就是将IP地址和域名的对应关系缓存起来，从而使得第二次访问同一个域名时，能够快速找到对应的IP地址，提高浏览器的第二次访问速度

* **页面资源缓存**

  ​	页面资源缓存主要是针对于讲访问的页面资源保存下来，实现这一个过程是主要通过请求头和响应头。

  `Cache-control： max-age = <seconds>` 声明缓存有效的时长，也就是说在这个时间段内，访问该网址的资源的话，会直接从缓存中读取

  如果超过这个 `max-age`指定的时间，那么浏览器会向服务器发送一个请求，如果服务器返回的是一个304 Not-modified 那么表明所访问的资源并没有改变，因此可以继续使用缓存，但是服务器端在生成状态码为304响应的时候，必须同时生成一下会存在于对应的200相应中的首部：Cache-Control、Content-Location、Date、ETag、Expires 和 Vary

  If-None-Match 要与ETag结合起来使用， ETag是一个资源的特定版本标识符，可以用来比较和识别服务器上的资源是否已经发生了变化

### 登录状态缓存

  * 用户输入用户名和密码发送给服务器，服务器验证用户信息正确后，会生成一端表示用户身份的字符串，并把这个字符串写到响应头set-cookie字段，
  * 当浏览器接收到响应后，会解析所返回的响应的响应头，如果响应头有set-cookie字段，那么会把这个字段所对应的字符串存储到浏览器本地，也就是存储到浏览器的cookie中
  * 当用户再次发起请求时，浏览器会自动将cookie中存储的信息写进请求头中的cookie字段里，
  * 服务器接收到请求后，解析请求头，拿到请求头中cookie字段对应的字符串，并查找后台，判断该用户的登录状态，然后生成包含该用户信息的页面数据，并把生成的数据发送给浏览器。
